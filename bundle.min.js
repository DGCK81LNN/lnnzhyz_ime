(()=>{var M=Object.defineProperty;var W=(e,n)=>{for(var t in n)M(e,t,{get:n[t],enumerable:!0})};var p=class{get scanned(){return this._scanned}constructor(n,t=0){this.string=n,this.scanPos=t,this._scanned=""}scan(n){typeof n=="string"&&(n=n.split(" "));for(let t of n)if(this.string.startsWith(t,this.scanPos))return this.scanPos+=t.length,this._scanned=t,t;return this._scanned="",""}};function c(e,n){return e===void 0?!1:n.split(" ").includes(e)}function Y(e){if(e.scan("ng w b p m f d t n l g k h j q x zh ch sh r z c s"))return e.scanned}function G(e,n=""){return e.scan("iung")?["y","e","ng"]:c(n,"zh ch sh r z c s")&&e.scan("ih")?["","",""]:e.scan("eo")?["","e",""]:!n&&e.scan("er ar")?["",e.scanned[0],"r"]:[e.scan("i u y")||"",e.scan("e a o")||"",e.scan("ng i u n")||""]}function J(e,n,t,r){if(!(n||t||r))return c(e,"zh ch sh r z c s m n ng")?s():c(e,"d l")?s("e"):null;let a=c(r,"i u");if(!t){if(!e&&n==="u"&&r&&!a)return["","o",r];if(r)return s("e")}if(t==="o")return!e&&!n&&t&&!a?s():!n&&!r?["u","e",""]:n==="i"&&r==="ng"?["y","e","ng"]:s("e");if(t==="e")return!e&&!n&&t&&!r?s("eh"):s();return s();function s(k=t){return[n||"",k||"",r||""]}}var Q=["",..."bpmfdtnlgkhjqx","zh","ch","sh",..."rzcs"],U=["i","u","y"],V=["e","a","o","eh"],X=["i","u","n","ng","r"];function ee(e){if(!e||c(e,"0 1 w"))return 1;if(c(e,"2 z"))return 2;if(c(e,"3 x"))return 3;if(c(e,"4 h"))return 4;throw new Error("Invalid tone")}var f=class{constructor(n="",t="",r="",a="",s=0){this.initial=n,this.glide=t,this.vowel=r,this.coda=a,this.tone=s}static scanRoman(n){let t=new p(n);if(t.scan("hm0 hm1 hng0 hng1"))return{end:t.scanPos,data:new f("h","","",t.scanned.slice(1,-1),0),fine:!0};if(t.scan("hm hng"))return{end:t.scanPos,data:new f("h","","",t.scanned.slice(1),0),fine:t.scanPos<n.length};let r=Y(t),a=G(t,r),s=J(r,...a);if(!s)return{end:0,data:null,fine:t.scanPos<n.length};let[k,N,Z]=s;c(r,"ng w")&&(r=""),t.scan("0 1 2 3 4 w z x h");let _=!!t.scanned||n.length>t.scanPos,K=ee(t.scanned);return{end:t.scanPos,data:new f(r,k,N,Z,K),fine:_}}inspect(){return`[${[this.initial,this.glide,this.vowel,this.coda,this.tone].filter(t=>!!t).join("-")}]`}toString(){let n=Q.indexOf(this.initial);if(n===-1)throw new Error("Invalid syllable");let t=String.fromCharCode(57424+n);if(this.tone===0){if(this.coda==="m")return t+"\uE080";if(this.coda==="ng")return t+"\uE081";throw new Error("Invalid syllable")}let r=U.indexOf(this.glide),a=V.indexOf(this.vowel),s=X.indexOf(this.coda);return t+=String.fromCharCode(57456+(this.tone-1)),r!==-1&&(t+=String.fromCharCode(57460+r)),a!==-1&&(t+=String.fromCharCode(57463+a)),s!==-1&&(t+=String.fromCharCode(57467+s)),t}};var x={};W(x,{scanRoman:()=>L});var C={"0":"\uE040","1":"\uE041","2":"\uE042","3":"\uE043","4":"\uE044","5":"\uE045","6":"\uE046","7":"\uE047","8":"\uE048","9":"\uE049",xa:"\uE04A",xb:"\uE04B",xc:"\uE04C",xd:"\uE04D",xe:"\uE04E",xf:"\uE04F",w:"\uE050",b:"\uE051",p:"\uE052",m:"\uE053",f:"\uE054",d:"\uE055",t:"\uE056",n:"\uE057",l:"\uE058",g:"\uE059",k:"\uE05A",h:"\uE05B",j:"\uE05C",q:"\uE05D",x:"\uE05E",zh:"\uE05F",ch:"\uE060",sh:"\uE061",r:"\uE062",z:"\uE063",c:"\uE064",s:"\uE065",v:"\uE066",i:"\uE067",u:"\uE068",y:"\uE069",e:"\uE06A",a:"\uE06B",o:"\uE06C",er:"\uE06D",_:"\uE06E","-":"- ","--":"\u2013 ","---":"\u2014 ",".":"\uFF61 ","..":". ","...":"\u2026 ",",":", ",",,":"\uFF64 "},$=Object.keys(C);function L(e){for(let n=e.length;n;--n){let t=e.slice(0,n);if(t in C)return{end:n,result:C[t],fine:!$.some(r=>r!==t&&r.startsWith(e))}}return{end:0,result:null,fine:!$.some(n=>n.startsWith(e))}}function P(e){let n=e[0].toLowerCase(),t=n+e.slice(1),r=e[0]!==n?"\uE06F":"",a=L(t),s=f.scanRoman(t);return a.result&&(s===null||s.end<=a.end)?{end:a.end,result:r+a.result,data:a.result,fine:a.fine&&s.fine}:s.data?{end:s.end,result:r+s.data.toString(),data:s.data,fine:s.fine}:{end:0,result:"",data:null,fine:s.fine&&a.fine}}var j=/^\ue06f$/,ne=/^[\ue070-\ue081]$/;function D(e,n){return!(n>0&&e[n-1].match(j)||n<e.length&&e[n].match(ne))}function h(e,n,t){if(n<0?n=0:n>e.length&&(n=e.length),t||(n>0&&e[n-1].match(j)?t="left":t="right"),t==="left")for(;n>0&&!D(e,n);)n--;else for(;n<e.length&&!D(e,n);)n++;return n}function d(e){return document.getElementById(e)}if(/^iP|^Mac/.test(navigator.platform))try{document.querySelector("meta[name=viewport]").content+=",user-scalable=no"}catch(e){}var i=d("input"),re=d("input-faux"),ie=d("input-faux-content"),B=d("input-floater"),se=d("input-floater-prev"),ue=d("input-floater-comp"),S=d("toggle"),g=!1;function I(){i.style.height="auto";var e=i.scrollHeight,n=`${e+2}px`;i.style.height=n,re.style.height=n}i.addEventListener("input",()=>void I());window.addEventListener("resize",()=>void I());function F(){var e=i.selectionStart,n=i.selectionEnd;return i.selectionDirection==="backward"?[n,e]:[e,n]}function y(e,n){n<e?i.setSelectionRange(n,e,"backward"):i.setSelectionRange(e,n,"forward")}function ae(){let[e,n]=F();e=h(i.value,e),n=h(i.value,n),y(e,n)}function T(e,n){let[t,r]=F();return n?(r+=e?1:-1,r=h(i.value,r,e?"right":"left"),y(t,r),!0):t===r?(r+=e?1:-1,r=h(i.value,r,e?"right":"left"),y(r,r),!0):!1}function q(e){let[n,t]=F();return n===t?(t+=e?1:-1,t=h(i.value,t,e?"right":"left"),y(n,t),b(""),!0):!1}var z=!1;i.addEventListener("focus",()=>{z=!0});i.addEventListener("blur",()=>{z=!1});i.addEventListener("keydown",e=>{if(e.key==="ArrowLeft"){T(!1,e.shiftKey)&&e.preventDefault();return}if(e.key==="ArrowRight"){T(!0,e.shiftKey)&&e.preventDefault();return}if(!u){if(e.key==="Backspace"){q(!1)&&e.preventDefault();return}if(e.key==="Delete"){q(!0)&&e.preventDefault();return}}});document.addEventListener("selectionchange",()=>{!g&&z&&ae()});function b(e){i.focus(),g=!0,document.execCommand("insertText",!1,e)||i.setRangeText(e,i.selectionStart,i.selectionEnd,"end"),g=!1,R=i.selectionStart}function v(){let e=(o&&o.result||"")+u.slice(o&&o.end||0);e?(ie.textContent=i.value.slice(0,i.selectionStart),B.classList.add("visible"),se.textContent=e,ue.textContent=u):B.classList.remove("visible")}var l=!0,u="",o,R=0;function O(e){l=e,!e&&u&&m()}function w(){if(!u){o=null,v();return}if(o=P(u),!o.result&&o.fine)return b(u[0]),u=u.slice(1),w();if(v(),o.fine)return A()}function A(){if(!o.result)return H();u=u.slice(o.end);let e=o.result;o=null,v(),b(e),u&&w()}function H(){b(u),m()}function m(){u="",o=null,v()}i.addEventListener("blur",()=>{l&&m()});document.addEventListener("selectionchange",()=>{l&&!g&&i.selectionStart!==R&&m()});var E=!1;i.addEventListener("keydown",e=>{if(E=!1,e.key==="Shift"){E=!0;return}if(!(!l||!u)){if(e.key==="Backspace")return e.preventDefault(),u=u.slice(0,-1),w();if(e.key===" ")return e.preventDefault(),A();if(e.key==="Enter")return e.preventDefault(),H();if(e.key==="Escape")return e.preventDefault(),m()}});i.addEventListener("keyup",e=>{e.key==="Shift"&&E&&(O(!l),S.checked=l)});i.addEventListener("beforeinput",e=>{!l||g||e.inputType!=="insertText"||(e.preventDefault(),u+=e.data,R=i.selectionStart,w())});S.addEventListener("change",()=>{O(S.checked)});})();
//# sourceMappingURL=bundle.min.js.map
